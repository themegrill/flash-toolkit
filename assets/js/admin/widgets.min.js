jQuery(function(l){var n;function s(t){var e=t.find(".tg-widget-repeater-field-items"),i=e.find("li.tg-widget-accordion-item"),o=wp.template("tg-widget-repeater-field-blank");i.length?(t.find(".tg-widget-repeater-field-button").show(),i.length<flashToolkitLocalizeScript.i18n_max_field_entries&&t.find(".tg-widget-repeater-field-button a").removeClass("disabled")):(t.find(".tg-widget-repeater-field-button").hide(),t.find(".tg-widget-repeater-field-blank-state").remove(),e.append(o))}function i(t){t.find(".tg-widget-repeater-field-items").sortable({items:"> li",handle:"> .accordion-top > .accordion-title",cursor:"move",axis:"y",distance:2,opacity:.65,scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,placeholder:"tg-widget-sortable-placeholder",start:function(t,e){var i=e.item.children(".accordion-inside");"block"===i.css("display")&&(e.item.removeClass("open"),i.hide(),l(this).sortable("refreshPositions"))},stop:function(t,e){e.item.removeAttr("style")}})}l(document.body).on("click",".tg-image-upload",function(t){var e=l(this),i=e.parent().find(".tg-media-input"),o=e.parent().parent().find(".tg-media-preview");t.preventDefault(),(n=wp.media.frames.media_file=wp.media({title:e.data("choose"),button:{text:e.data("update")},states:[new wp.media.controller.Library({title:e.data("choose"),library:wp.media.query({type:"image"})})]})).on("select",function(){var t=n.state().get("selection").first().toJSON();i.val(t.url),o.css({display:"none"}).find("img").remove(),o.css({display:"block"}).append('<img src="'+t.url+'">')}),n.open()}),l(document.body).on("click",".tg-media-remove",function(){var t=l(this).closest(".media-uploader");return t.find(".tg-media-input").val(""),t.find(".tg-media-preview").css({display:"none"}).find("img").remove(),!1}),l(document.body).on("flash-toolkit-init-media-preview",function(){l("input.tg-media-input").each(function(){var t=l(this).val(),e=l(this).parent().siblings(".tg-media-preview");""!==t&&(e.find("img.tg-media-preview-default").remove(),e.css({display:"block"}).append('<img src="'+t+'">'))})}).trigger("flash-toolkit-init-media-preview"),l(document.body).on("flash-toolkit-date-picker-init",function(){l("input.flash-datetime-picker").removeClass("hasDatepicker"),l("input.flash-datetime-picker").each(function(){l("input.flash-datetime-picker").datetimepicker({dateFormat:"yy-mm-dd",timeFormat:"HH:mm"})})}).trigger("flash-toolkit-date-picker-init"),l(document.body).on("flash-toolkit-color-picker-init",function(){l(".ft-widget-col:has(.flash-color-picker)").each(function(){l(this).find(".flash-color-picker").wpColorPicker()})}).trigger("flash-toolkit-color-picker-init"),l(document.body).on("panelsopen",function(){l(document.body).trigger("flash-toolkit-date-picker-init"),l(document.body).trigger("flash-toolkit-color-picker-init")}),l(document.body).on("flash-toolkit-init-availability",function(){l("select.icon_chooser").change(function(){"image"===l(this).val()?(l(this).closest("p").next(".show_if_icon").hide(),l(this).closest("p").next().next(".show_if_image").show()):(l(this).closest("p").next(".show_if_icon").show(),l(this).closest("p").next().next(".show_if_image").hide())}).change(),l("select.media_chooser").change(function(){"image"===l(this).val()?(l(this).closest(".widget-content").find(".show_if_image").show(),l(this).closest(".widget-content").find(".show_if_video").closest("p").hide()):(l(this).closest(".widget-content").find(".show_if_image").hide(),l(this).closest(".widget-content").find(".show_if_video").closest("p").show())}).change(),l("select.filter_availability").change(function(){"0"===l(this).val()?l(this).closest(".widget-content").find(".show_if_all_category").closest("p").show():l(this).closest(".widget-content").find(".show_if_all_category").closest("p").hide()}).change(),l("select.availability").change(function(){"latest"===l(this).val()?l(this).closest("p").next("p").hide():l(this).closest("p").next("p").show()}).change(),l("input.availability").change(function(){l(this).is(":checked")?l(this).closest("p").next("p").hide():l(this).closest("p").next("p").show()}).change(),l("select.videoplayer-style").change(function(){"player-background"===l(this).val()?(l(this).closest(".widget-content").find(".videoplayer-icon-style").closest("p").hide(),l(this).closest(".widget-content").find(".videoplayer-btn-fields").closest("p").hide(),l(this).closest(".widget-content").find(".videoplayer-thumbnail").show()):(l(this).closest(".widget-content").find(".videoplayer-icon-style").closest("p").show(),l(this).closest(".widget-content").find(".videoplayer-btn-fields").closest("p").show(),l(this).closest(".widget-content").find(".videoplayer-thumbnail").hide())}).change(),l("select.hero-style-select").on("select2:select",function(){"tg-hero--default"===l(this).val()?(l(this).closest(".widget-content").find(".hero-title-font-select").val("Roboto").trigger("change"),l(this).closest(".widget-content").find(".hero-subtitle-font-select").val("Roboto").trigger("change")):"tg-hero--thinner"===l(this).val()?(l(this).closest(".widget-content").find(".hero-title-font-select").val("Raleway").trigger("change"),l(this).closest(".widget-content").find(".hero-subtitle-font-select").val("Open Sans").trigger("change")):"tg-hero--border"===l(this).val()?(l(this).closest(".widget-content").find(".hero-title-font-select").val("Archivo Black").trigger("change"),l(this).closest(".widget-content").find(".hero-subtitle-font-select").val("Roboto").trigger("change")):"tg-hero--classic"===l(this).val()?(l(this).closest(".widget-content").find(".hero-title-font-select").val("Playfair Display").trigger("change"),l(this).closest(".widget-content").find(".hero-subtitle-font-select").val("PT Serif").trigger("change")):"tg-hero--cursive"===l(this).val()&&(l(this).closest(".widget-content").find(".hero-title-font-select").val("Lobster").trigger("change"),l(this).closest(".widget-content").find(".hero-subtitle-font-select").val("Roboto").trigger("change"))}).change()}).trigger("flash-toolkit-init-availability"),l(document.body).on("flash-toolkit-tabs",function(){l(document.body).on("click",".flash-tab-title-container .flash-tab-title",function(t){t.preventDefault(),l(this).addClass("active"),l(this).siblings().removeClass("active");var e=l(this).attr("href");l(this).parent().siblings(".flash-toolkit-tab-content-container").find(".flash-toolkit-tab").css("display","none"),l(this).parent().siblings(".flash-toolkit-tab-content-container").find(e).fadeIn()})}).trigger("flash-toolkit-tabs"),l(document.body).on("flash-toolkit-init-accordion-title",function(){l(".tg-widget-repeater-field-items").children("li").each(function(){var t=l('input[id*="-title"]',this).val()||"";t&&(t=": "+t.replace(/<[^<>]+>/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;")),l(this).children(".accordion-top").children(".accordion-title").children().children(".in-accordion-title").html(t)})}).trigger("flash-toolkit-init-accordion-title"),l(document.body).on("click",".tg-widget-repeater-field-add",function(t){if(t.preventDefault(),l(this).is(".disabled"))window.alert(flashToolkitLocalizeScript.i18n_max_field_message);else{var e=l(this).parents(".widget-content"),i=e.find("li.tg-widget-accordion-item").length+1,o=e.find(".tg-widget-repeater-field-items").data("widget_id"),n=wp.template("tg-widget-repeater-field-"+o);e.find("li.tg-widget-accordion-item").each(function(t,e){i===parseInt(l(e).data("id").replace(/[^0-9\.]/g,""),10)&&i++}),e.find(".tg-widget-repeater-field-button").show(),e.find(".tg-widget-repeater-field-blank-state").remove(),e.find(".tg-widget-repeater-field-items").append(n({field_id:i})),i>=flashToolkitLocalizeScript.i18n_max_field_entries&&e.find(".tg-widget-repeater-field-button a").addClass("disabled"),l(document.body).trigger("flash-enhanced-select-init")}}),l(document.body).on("click.accordion-toggle",function(t){var e,i,o,n=l(t.target);n.parents(".accordion-top").length&&!n.parents("#available-fields").length?((i=(e=n.closest("li.tg-widget-accordion-item")).children(".accordion-inside")).is(":hidden")?(e.addClass("open"),i.slideDown("fast")):i.slideUp("fast",function(){e.attr("style",""),e.removeClass("open")}),t.preventDefault()):n.hasClass("accordion-control-close")?((e=n.closest("li.tg-widget-accordion-item")).children(".accordion-inside").slideUp("fast",function(){e.attr("style",""),e.removeClass("open")}),t.preventDefault()):n.hasClass("accordion-control-remove")&&(e=n.closest("li.tg-widget-accordion-item"),o=n.parents(".widget[id*=themegrill_flash], .widget-content"),e.remove(),s(o),t.preventDefault())}),l(document.body).on("panelsopen",function(t){var e=l(t.target);if(!e.has(".tg-widget-repeater-field-items"))return!1;e.addClass("widget-content"),s(e),i(e),l(document.body).trigger("flash-enhanced-select-init"),l(document.body).trigger("flash-toolkit-init-availability"),l(document.body).trigger("flash-toolkit-init-media-preview"),l(document.body).trigger("flash-toolkit-init-accordion-title")}),l(document.body).on("click",".so-close",function(){l(document.body).trigger("flash-toolkit-init-accordion-title")}),l(document.body).on("click","div.widget[id*=themegrill_flash] .widget-title, div.widget[id*=themegrill_flash] .widget-title-action",function(){l(this).parents("#available-widgets").length||(s(l(this).parents(".widget[id*=themegrill_flash]")),i(l(this).parents(".widget[id*=themegrill_flash]")))}),l(document).on("widget-added widget-updated",function(t,e){e.is("[id*=themegrill_flash]")&&(t.preventDefault(),s(e),i(e),l(document.body).trigger("flash-enhanced-select-init"),l(document.body).trigger("flash-toolkit-init-availability"),l(document.body).trigger("flash-toolkit-init-media-preview"),l(document.body).trigger("flash-toolkit-init-accordion-title"),l(document.body).trigger("flash-toolkit-date-picker-init"),l(document.body).trigger("flash-toolkit-color-picker-init"))})});